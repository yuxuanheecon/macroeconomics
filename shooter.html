<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Macro Defender 4.5 | Earth Macro</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    /* ====== Âü∫Á°ÄÊ†∑Âºè ====== */
    body {
      margin: 0; overflow: hidden; background: #050505; color: white; font-family: 'JetBrains Mono', monospace;
      user-select: none; cursor: crosshair;
    }
    
    .scanlines {
      position: fixed; left: 0; top: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 50;
      background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
      background-size: 100% 4px;
    }

    /* ====== UI Â±Ç ====== */
    #ui-layer {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;
      display: flex; flex-direction: column; justify-content: space-between; padding: 20px; box-sizing: border-box;
      z-index: 10;
    }

    /* È°∂ÈÉ® HUD */
    .hud-top { display: flex; justify-content: space-between; align-items: flex-start; }
    .hud-left { display: flex; gap: 15px; }
    .hud-right { display: flex; gap: 10px; pointer-events: auto; }

    .stat-box { text-shadow: 0 0 10px currentColor; background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 4px; border: 1px solid #333; }
    .label { font-size: 0.7rem; color: #888; display: block; letter-spacing: 1px; margin-bottom: 2px; }
    .value { font-family: 'Share Tech Mono'; font-size: 1.5rem; font-weight: bold; }
    #score-val { color: #00ff9d; }
    #health-val { color: #00f3ff; }
    #cycle-val { color: #ffee00; }

    .hud-btn {
      background: rgba(0,0,0,0.6); border: 1px solid #555; color: #aaa;
      padding: 8px 15px; cursor: pointer; font-family: 'JetBrains Mono'; font-size: 0.8rem;
      transition: all 0.2s; border-radius: 4px;
    }
    .hud-btn:hover { border-color: #fff; color: #fff; background: rgba(255,255,255,0.1); }

    /* Â∫ïÈÉ® HUD */
    .hud-bottom { display: flex; justify-content: center; align-items: flex-end; width: 100%; pointer-events: auto; position: relative; }
    
    .skill-panel { display: flex; gap: 10px; align-items: center; margin-bottom: 10px; }
    .skill-slot {
      width: 60px; height: 60px; border: 2px solid #444; background: rgba(0,0,0,0.7);
      position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center;
      border-radius: 8px; transition: all 0.1s; overflow: hidden; cursor: help;
    }
    .skill-slot.ready { border-color: var(--color); box-shadow: 0 0 10px var(--color); }
    .skill-slot.cooldown { border-color: #333; opacity: 0.6; filter: grayscale(1); }
    .skill-key { position: absolute; top: 2px; left: 2px; background: #000; border: 1px solid #555; color: #fff; font-size: 0.6rem; padding: 1px 4px; border-radius: 2px; }
    .skill-icon { font-size: 1.5rem; }
    .cooldown-overlay {
      position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.8);
      height: 0%; transition: height 0.1s linear; display: flex; justify-content: center; align-items: center;
    }
    .cooldown-text { color: white; font-weight: bold; font-size: 1rem; font-family: 'Share Tech Mono'; }

    /* Ë£ÖÂ§áÊ†è */
    .inventory-panel { display: flex; gap: 5px; background: rgba(0,0,0,0.6); padding: 5px; border: 1px solid #333; border-radius: 6px; margin-left: 20px; margin-bottom: 10px; }
    .item-slot {
      width: 45px; height: 45px; border: 1px solid #444; background: rgba(0,0,0,0.8);
      display: flex; justify-content: center; align-items: center; font-size: 1.5rem; position: relative;
      cursor: help; transition: border-color 0.2s;
    }
    .item-slot:hover { border-color: #fff; }
    .item-slot.empty { color: #222; font-size: 0.8rem; }

    .shop-hint { position: absolute; right: 20px; bottom: 20px; color: #ffee00; border: 1px solid #ffee00; padding: 8px; font-size: 0.8rem; animation: pulse 2s infinite; cursor: pointer; }
    @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

    /* Tooltip - ‰øÆÂ§ç‰∫ÜÂ±ÇÁ∫ßÈóÆÈ¢ò */
    #global-tooltip {
      position: absolute; top: 0; left: 0;
      background: rgba(5, 10, 15, 0.98); border: 1px solid var(--neon-blue);
      padding: 15px; border-radius: 8px; width: 280px; pointer-events: none;
      display: none; text-align: left; box-shadow: 0 0 30px rgba(0,0,0,1); z-index: 9999; /* Á°Æ‰øùÊúÄÈ´òÂ±ÇÁ∫ß */
    }
    #tt-header { border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
    #tt-title { color: #00f3ff; font-size: 1rem; font-family: 'Share Tech Mono'; margin: 0; font-weight: bold; }
    #tt-cost { color: #ffee00; font-size: 0.8rem; font-family: 'Share Tech Mono'; }
    #tt-desc { color: #ccc; font-size: 0.8rem; line-height: 1.5; margin-bottom: 8px; }
    #tt-info { color: #888; font-size: 0.75rem; display: grid; grid-template-columns: 1fr; gap: 3px; }
    #tt-info span { color: #aaa; }
    #tt-info b { color: #fff; }

    /* ====== Ê®°ÊÄÅÁ™óÂè£ ====== */
    .modal {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(5,5,8,0.98); display: flex; flex-direction: column;
      z-index: 100; pointer-events: auto; overflow-y: auto;
    }
    .modal.hidden { display: none !important; }
    
    .modal-content { width: 100%; max-width: 1200px; margin: 0 auto; padding: 30px; display: flex; flex-direction: column; height: 100%; align-items: center; }

    h1 { font-family: 'Share Tech Mono'; font-size: 2.5rem; color: #00f3ff; text-shadow: 0 0 20px #00f3ff; margin: 10px 0; }
    p.subtitle { color: #888; margin-bottom: 20px; font-size: 0.9rem; text-align: center; }

    .btn {
      background: transparent; border: 2px solid #00ff9d; color: #00ff9d;
      padding: 10px 25px; font-size: 1rem; font-family: 'Share Tech Mono';
      cursor: pointer; box-shadow: 0 0 15px rgba(0,255,157,0.2); transition: all 0.2s;
      margin: 5px;
    }
    .btn:hover { background: #00ff9d; color: black; box-shadow: 0 0 30px rgba(0,255,157,0.4); transform: scale(1.05); }
    .btn-red { border-color: #ff0055; color: #ff0055; }
    .btn-red:hover { background: #ff0055; color: white; }

    /* ÈÄâ‰∫∫ÁïåÈù¢ */
    .category-tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; width: 100%; }
    .tab-btn {
      padding: 8px 20px; background: rgba(255,255,255,0.05); border: 1px solid #444; color: #888;
      cursor: pointer; font-family: 'JetBrains Mono'; font-size: 0.9rem; transition: all 0.2s;
      border-radius: 4px;
    }
    .tab-btn:hover { border-color: #fff; color: #fff; }
    .tab-btn.active { background: rgba(0, 243, 255, 0.15); border-color: #00f3ff; color: #00f3ff; font-weight: bold; }

    .char-selection-area { display: flex; gap: 20px; flex: 1; width: 100%; overflow: hidden; }
    .char-list { 
      flex: 2; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); 
      grid-auto-rows: 150px; gap: 10px; overflow-y: auto; align-content: start; padding-right: 5px;
      border: 1px solid #333; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;
    }
    .char-detail-panel { flex: 1; background: rgba(10,15,20,0.95); border: 1px solid #00f3ff; padding: 20px; overflow-y: auto; min-width: 320px; display:flex; flex-direction:column; align-items:center; border-radius: 12px; }
    
    .char-mini-card { background: rgba(255,255,255,0.05); border: 1px solid #444; padding: 10px; cursor: pointer; text-align: center; border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.2s; }
    .char-mini-card:hover { background: rgba(255,255,255,0.1); transform: translateY(-2px); }
    .char-mini-card.selected { border-color: #ffee00; background: rgba(255,238,0,0.15); box-shadow: inset 0 0 10px rgba(255,238,0,0.2); }
    .mini-avatar { width: 60px; height: 60px; border-radius: 50%; margin-bottom: 10px; background: #000; object-fit: cover; }
    .mini-name { font-size: 0.7rem; font-weight: bold; color: #eee; line-height: 1.2; }

    .stat-bar { height: 4px; background: #333; width: 100%; margin-top: 3px; border-radius: 2px; }
    .stat-fill { height: 100%; background: #00f3ff; border-radius: 2px; }
    
    .skill-list { width: 100%; text-align: left; font-size: 0.85rem; margin-top: 10px; flex: 1; }
    .skill-item { 
      margin-bottom: 8px; border-bottom: 1px solid #333; padding-bottom: 8px; 
      cursor: help; position: relative; transition: background 0.2s; padding: 5px; border-radius: 4px;
      display: flex; flex-direction: column;
    }
    .skill-item:hover { background: rgba(255,255,255,0.05); border-color: #00f3ff; }
    .skill-header { display: flex; align-items: center; gap: 8px; margin-bottom: 2px; }
    .skill-name-txt { color: #fff; font-weight: bold; font-size: 0.9rem; }
    .skill-desc-txt { font-size: 0.7rem; color: #888; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .key-badge { display: inline-block; background: #333; color: #00f3ff; padding: 1px 4px; border-radius: 2px; font-size: 0.7rem; font-family: monospace; min-width: 18px; text-align: center; border: 1px solid #555; }

    /* ÂïÜÂ∫ó */
    #shop-menu h1 { border-bottom: 2px solid #333; width: 100%; text-align: center; padding-bottom: 10px; }
    .shop-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; width: 100%; max-height: 60vh; overflow-y: auto; }
    .shop-item-card { background: rgba(255,255,255,0.05); border: 1px solid #444; padding: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; transition: 0.2s; cursor: pointer; position: relative; }
    .shop-item-card:hover { border-color: #00f3ff; transform: translateY(-3px); background: rgba(255,255,255,0.08); }
    .shop-item-type { position: absolute; top: 5px; right: 5px; font-size: 0.6rem; color: #666; text-transform: uppercase; }
    
    .floating-text { position: absolute; font-weight: bold; pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 20; text-shadow: 1px 1px 2px black; font-size: 0.9rem; }
    @keyframes floatUp { from { transform: translateY(0); opacity: 1; } to { transform: translateY(-30px); opacity: 0; } }
    
    /* ‰øÆÂ§çËßÑÂàôÈ°µ */
    .rules-box { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px; width: 100%; margin-bottom: 20px; line-height: 1.6; }
    .key-tag { background: #333; padding: 2px 5px; border-radius: 3px; color: #fff; font-family: monospace; }
    .diff-select { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
    .diff-btn { padding: 8px 20px; border: 1px solid #555; cursor: pointer; color: #888; }
    .diff-btn.active { border-color: #00f3ff; color: #00f3ff; font-weight: bold; }

    @media (max-width: 900px) {
      .char-selection-area { flex-direction: column; }
    }
  </style>
</head>
<body>

  <canvas id="gameCanvas"></canvas>
  <div class="scanlines"></div>

  <!-- ÂÖ®Â±Ä Tooltip (Z-Index 9999) -->
  <div id="global-tooltip">
    <div id="tt-header">
      <div id="tt-title">Title</div>
      <div id="tt-cost"></div>
    </div>
    <div id="tt-desc">Description</div>
    <div id="tt-info"></div>
  </div>

  <!-- Ê∏∏ÊàèÂÜÖ HUD (Start hidden) -->
  <div id="ui-layer" class="hidden">
    <div class="hud-top">
      <div class="hud-left">
        <div class="stat-box"><span class="label">GDP (GOLD)</span><div class="value" id="score-val">0</div></div>
        <div class="stat-box"><span class="label">CYCLE</span><div class="value" id="cycle-val">-</div></div>
        <div class="stat-box"><span class="label">LIQUIDITY (HP)</span><div class="value" id="health-val">100%</div></div>
      </div>
      <div class="hud-right">
        <div class="hud-btn" onclick="togglePause()">‚è∏Ô∏è PAUSE</div>
        <div class="hud-btn" onclick="location.reload()">üîÑ ABORT</div>
      </div>
    </div>

    <div class="hud-bottom">
      <div style="display:flex; align-items:flex-end; gap:20px; justify-content:center;">
        <div class="skill-panel">
          <div class="skill-slot" style="--color:#fff; border-color:#fff;">
            <span class="skill-key">A</span><span class="skill-icon">üî´</span>
          </div>
          <!-- Skills with Tooltips -->
          <div class="skill-slot" id="skill-q" style="--color:#00f3ff" onmouseenter="showGameTooltip(this, 'q')" onmouseleave="hideTooltip()">
            <span class="skill-key">Q</span><span class="skill-icon">üí†</span>
            <div class="cooldown-overlay"><span class="cooldown-text"></span></div>
          </div>
          <div class="skill-slot" id="skill-w" style="--color:#00ff9d" onmouseenter="showGameTooltip(this, 'w')" onmouseleave="hideTooltip()">
            <span class="skill-key">W</span><span class="skill-icon">üõ°Ô∏è</span>
            <div class="cooldown-overlay"><span class="cooldown-text"></span></div>
          </div>
          <div class="skill-slot" id="skill-e" style="--color:#ffee00" onmouseenter="showGameTooltip(this, 'e')" onmouseleave="hideTooltip()">
            <span class="skill-key">E</span><span class="skill-icon">‚ö°</span>
            <div class="cooldown-overlay"><span class="cooldown-text"></span></div>
          </div>
          <div class="skill-slot" id="skill-r" style="--color:#ff0055" onmouseenter="showGameTooltip(this, 'r')" onmouseleave="hideTooltip()">
            <span class="skill-key">R</span><span class="skill-icon">‚ò¢Ô∏è</span>
            <div class="cooldown-overlay"><span class="cooldown-text"></span></div>
          </div>
        </div>
        
        <!-- Ë£ÖÂ§áÊ†è (Interactive) -->
        <div class="inventory-panel" id="inventory-display">
          <div class="item-slot empty" data-idx="0"></div>
          <div class="item-slot empty" data-idx="1"></div>
          <div class="item-slot empty" data-idx="2"></div>
          <div class="item-slot empty" data-idx="3"></div>
          <div class="item-slot empty" data-idx="4"></div>
          <div class="item-slot empty" data-idx="5"></div>
        </div>
        
        <div class="shop-hint" onclick="toggleShop()">SHOP [B]</div>
      </div>
    </div>
  </div>

  <!-- 1. ËßÑÂàô/ÈöæÂ∫¶ -->
  <div id="screen-rules" class="modal">
    <div class="modal-content" style="justify-content:center;">
      <h1>MACRO DEFENDER 4.5</h1>
      <p class="subtitle">Global Economy Defense Initiative</p>
      <div class="rules-box">
        <h3>üî∞ ‰ªªÂä°ÁÆÄÊä• (Briefing)</h3>
        <p>
          1. <strong>ÈÄâÊã©È¢ÜË¢ñ</strong>Ôºö‰ªéÂ§ÆË°å„ÄÅÊîøÁïå„ÄÅÂçéÂ∞îË°óÊàñÁßëÊäÄÁïåÈÄâÊã©‰Ω†ÁöÑËã±ÈõÑ„ÄÇ<br>
          2. <strong>Êìç‰Ωú</strong>Ôºö<span class="key-tag">Âè≥ÈîÆ</span>ÁßªÂä®Ôºå<span class="key-tag">A</span>ÈîÆÂ∞ÑÂáªÔºå<span class="key-tag">QWER</span>ÈáäÊîæÊäÄËÉΩ„ÄÇ<br>
          3. <strong>Èò≤Âæ°</strong>ÔºöÂáªÈÄÄÈÄöËÉÄÊÅ∂È≠î‰∏éËµÑ‰∫ßÊ≥°Ê≤´Ôºå‰øùÊä§ÊµÅÂä®ÊÄß(HP)‰∏çÂΩíÈõ∂„ÄÇ<br>
          4. <strong>ÊàêÈïø</strong>ÔºöÂáªÊùÄËé∑ GDPÔºåÊåâ <span class="key-tag">B</span> ÈîÆË¥≠‰π∞Âº∫ÂåñË£ÖÂ§á„ÄÇ
        </p>
      </div>
      <p>SELECT DIFFICULTY</p>
      <div class="diff-select">
        <div class="diff-btn" onclick="setDifficulty(0.8, this)">EASY (ÁÆÄÂçï)</div>
        <div class="diff-btn active" onclick="setDifficulty(1, this)">NORMAL (ÊôÆÈÄö)</div>
        <div class="diff-btn" onclick="setDifficulty(1.5, this)">HARD (Âõ∞Èöæ)</div>
      </div>
      <button class="btn" style="width:300px;" onclick="goToCharSelect()">NEXT: SELECT HERO</button>
    </div>
  </div>

  <!-- 2. ÈÄâ‰∫∫ÁïåÈù¢ -->
  <div id="screen-char" class="modal hidden">
    <div class="modal-content">
      <h1>SELECT HERO</h1>
      <div class="category-tabs">
        <div class="tab-btn active" onclick="filterChars('banker')">üèõÔ∏è Â§ÆË°å</div>
        <div class="tab-btn" onclick="filterChars('politician')">ü¶Ö ÊîøË¶Å</div>
        <div class="tab-btn" onclick="filterChars('investor')">üíº ËµÑÊú¨</div>
        <div class="tab-btn" onclick="filterChars('tech')">üöÄ ÁßëÊäÄ</div>
        <div class="tab-btn" onclick="filterChars('org')">üåç ÁªÑÁªá</div>
      </div>
      <div class="char-selection-area">
        <div class="char-list" id="char-list-container"></div>
        <div class="char-detail-panel">
          <img id="detail-avatar" class="detail-avatar" src="" alt="Avatar">
          <div id="detail-name" class="detail-name">Name</div>
          <div id="detail-title" class="detail-title">Title</div>
          
          <div class="stats-grid" style="width:100%; font-size:0.8rem;">
            <div class="stat-row"><span class="stat-label">HP</span><div class="stat-track"><div class="stat-bar" id="bar-hp" style="width:0%"></div></div></div>
            <div class="stat-row"><span class="stat-label">ATK</span><div class="stat-track"><div class="stat-bar" id="bar-atk" style="width:0%"></div></div></div>
            <div class="stat-row"><span class="stat-label">SPD</span><div class="stat-track"><div class="stat-bar" id="bar-spd" style="width:0%"></div></div></div>
          </div>

          <div class="skill-list">
            <!-- Skills with tooltip triggers -->
            <div class="skill-item" onmouseenter="showSelectTooltip(this, 'q')" onmouseleave="hideTooltip()">
              <div class="skill-header"><span class="key-badge">Q</span> <span id="skill-q-name" class="skill-name-txt">-</span></div>
              <div id="skill-q-desc" class="skill-desc-txt">-</div>
            </div>
            <div class="skill-item" onmouseenter="showSelectTooltip(this, 'w')" onmouseleave="hideTooltip()">
              <div class="skill-header"><span class="key-badge">W</span> <span id="skill-w-name" class="skill-name-txt">-</span></div>
              <div id="skill-w-desc" class="skill-desc-txt">-</div>
            </div>
            <div class="skill-item" onmouseenter="showSelectTooltip(this, 'e')" onmouseleave="hideTooltip()">
              <div class="skill-header"><span class="key-badge">E</span> <span id="skill-e-name" class="skill-name-txt">-</span></div>
              <div id="skill-e-desc" class="skill-desc-txt">-</div>
            </div>
            <div class="skill-item" onmouseenter="showSelectTooltip(this, 'r')" onmouseleave="hideTooltip()">
              <div class="skill-header"><span class="key-badge">R</span> <span id="skill-r-name" class="skill-name-txt">-</span></div>
              <div id="skill-r-desc" class="skill-desc-txt">-</div>
            </div>
          </div>

          <button class="start-btn" style="margin-top:auto" onclick="startGame()">DEPLOY</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 3. ÊöÇÂÅúËèúÂçï -->
  <div id="pause-menu" class="modal hidden">
    <h1>SYSTEM PAUSED</h1>
    <button class="btn" onclick="togglePause()">RESUME</button>
    <button class="btn btn-red" onclick="location.reload()">ABORT MISSION</button>
  </div>

  <!-- 4. ÂïÜÂ∫ó -->
  <div id="shop-menu" class="modal hidden">
    <div class="modal-content">
      <h1>GDP STORE</h1>
      <p>Current GDP: <span id="shop-gdp" style="color:#00ff9d">$0</span></p>
      <div class="shop-container" id="shop-items-container">
        <!-- Items generated by JS -->
      </div>
      <button class="btn btn-red" style="margin-top:20px" onclick="toggleShop()">CLOSE [B]</button>
    </div>
  </div>

  <!-- 5. Ê∏∏ÊàèÁªìÊùü -->
  <div id="game-over" class="modal hidden">
    <h1 style="color:#ff0055">MARKET CRASH</h1>
    <p>Final GDP: <span id="final-score">0</span></p>
    <button class="btn" onclick="location.reload()">REBOOT</button>
  </div>

  <script>
    /* ====== Êï∞ÊçÆ‰∏≠ÂøÉ (Data) ====== */
    const CHARACTERS = {
      // 1. Bankers
      'powell': { cat: 'banker', name: 'Jerome Powell (È≤çÂ®ÅÂ∞î)', title: 'Fed Chair', hp: 7, atk: 4, spd: 5, rate: 8, color: '#00f3ff', q:'Hawk Shot', w:'Rate Shield', e:'Pivot Dash', r:'Infinite QE', qDesc:'Èπ∞Ê¥æ‰∏âËøûÂ∞Ñ', wDesc:'Âä†ÊÅØÊä§Áõæ', eDesc:'ÊîøÁ≠ñËΩ¨Âêë', rDesc:'Êó†ÈôêÂç∞Èíû', qInfo:'Dmg: Med | CD: 3s', wInfo:'Shield | CD: 8s', eInfo:'Dash | CD: 4s', rInfo:'Full Screen | CD: 30s' },
      'yellen': { cat: 'banker', name: 'Janet Yellen (ËÄ∂‰º¶)', title: 'Treasury Sec', hp: 6, atk: 5, spd: 5, rate: 7, color: '#0099ff', q:'Soft Landing', w:'Debt Ceiling', e:'Treasury Run', r:'Bailout', qDesc:'ËΩØÁùÄÈôÜÂºπÂπï', wDesc:'ÂÄ∫Âä°‰∏äÈôêÈò≤Âæ°Â°î', eDesc:'ÂõΩÂÄ∫ÁñæË∑ë', rDesc:'ÂÖ®ÂëòÂõûË°Ä', qInfo:'Slow | CD: 4s', wInfo:'Block | CD: 10s', eInfo:'Speed | CD: 5s', rInfo:'Heal | CD: 40s' },
      'bernanke': { cat: 'banker', name: 'Ben Bernanke (‰ºØÂçóÂÖã)', title: 'Ex-Fed Chair', hp: 6, atk: 3, spd: 4, rate: 9, color: '#00cc99', q:'Helicopter', w:'Stress Test', e:'QE Dash', r:'QE1', qDesc:'Áõ¥ÂçáÊú∫ÊííÈí±Êï£Â∞Ñ', wDesc:'ÂéãÂäõÊµãËØïÊä§Áõæ', eDesc:'ÈáèÂåñÂÜ≤Âà∫', rDesc:'ÈáèÂåñÂÆΩÊùæËΩ∞ÁÇ∏', qInfo:'AoE | CD: 5s', wInfo:'Def | CD: 12s', eInfo:'Dash | CD: 6s', rInfo:'Dmg | CD: 35s' },
      'greenspan': { cat: 'banker', name: 'Alan Greenspan (Ê†ºÊûóÊñØÊΩò)', title: 'Maestro', hp: 5, atk: 6, spd: 3, rate: 6, color: '#aaaaaa', q:'Fed Put', w:'Exuberance', e:'Bubble Ride', r:'Moderation', qDesc:'ÁúãË∑åÊúüÊùÉ', wDesc:'ÈùûÁêÜÊÄßÁπÅËç£', eDesc:'Ê≥°Ê≤´ÊºÇÁßª', rDesc:'Â§ßÁºìÂíåÂÆöË∫´', qInfo:'Shield | CD: 8s', wInfo:'Buff | CD: 15s', eInfo:'Move | CD: 5s', rInfo:'Stun | CD: 40s' },
      'lagarde': { cat: 'banker', name: 'Christine Lagarde (ÊãâÂä†Âæ∑)', title: 'ECB President', hp: 6, atk: 5, spd: 5, rate: 6, color: '#3366cc', q:'Euro Bond', w:'Fragment', e:'Unity Dash', r:'Whatever it takes', qDesc:'Ê¨ßÂÖÉÂõûÊóãÈïñ', wDesc:'ÂèçÂàÜË£ÇÁ´ãÂú∫', eDesc:'Áªü‰∏ÄÂÜ≤Âà∫', rDesc:'Âº∫ÂäõÂÖ®Â±èÈúáËç°', qInfo:'Return | CD: 4s', wInfo:'AoE Push | CD: 10s', eInfo:'Dash | CD: 5s', rInfo:'Massive Dmg | CD: 45s' },
      'draghi': { cat: 'banker', name: 'Mario Draghi', title: 'Super Mario', hp: 7, atk: 6, spd: 6, rate: 7, color: '#0055a4', q:'Bazooka', w:'Euro Shield', r:'Save the Euro', qDesc:'ÁÅ´ÁÆ≠Á≠íÈáçÂáª', wDesc:'Ê¨ßÂÖÉÁõæ', rDesc:'ÊãØÊïëÊ¨ßÂÖÉÂÖ®Â±èÊ∏ÖÂú∫' },
      'kuroda': { cat: 'banker', name: 'Haruhiko Kuroda', title: 'Ex-BOJ Gov', hp: 5, atk: 3, spd: 7, rate: 10, color: '#ff6600', q:'YCC Control', w:'Negative Rate', e:'Yen Slide', r:'Super Ease', qDesc:'YCCÂÆöË∫´', wDesc:'Ë¥üÂà©ÁéáÂäõÂú∫', eDesc:'Êó•ÂÖÉÊªëÂù°', rDesc:'Ë∂ÖÁ∫ßÂÆΩÊùæÂºπÂπïÈõ®', qInfo:'Stun | CD: 6s', wInfo:'AoE Slow | CD: 12s', eInfo:'Speed | CD: 5s', rInfo:'Barrage | CD: 30s' },
      'ueda': { cat: 'banker', name: 'Kazuo Ueda (Ê§çÁî∞ÂíåÁî∑)', title: 'BOJ Gov', hp: 6, atk: 4, spd: 6, rate: 8, color: '#ff9933', q:'Rate Hike', w:'YCC End', e:'Normal Path', r:'Exit', qDesc:'Âä†ÊÅØÂçïÁÇπ', wDesc:'YCCÁªàÁªì', eDesc:'Ê≠£Â∏∏ÂåñË∑ØÂæÑ', rDesc:'ÈÄÄÂá∫ÂÆΩÊùæ', qInfo:'Dmg | CD: 2s', wInfo:'Slow | CD: 10s', eInfo:'Dash | CD: 5s', rInfo:'Burst | CD: 40s' },
      'carney': { cat: 'banker', name: 'Mark Carney', title: 'Ex-BOE Gov', hp: 6, atk: 5, spd: 5, rate: 7, color: '#6600cc', q:'Forward Guidance', w:'Climate Risk', r:'Horizon', qDesc:'ÂâçÁûªÊåáÂºï', wDesc:'Ê∞îÂÄôÈ£éÈô©Ëø∑Èõæ', rDesc:'Âú∞Âπ≥Á∫øÂÜ≤Âáª' },
      'bailey': { cat: 'banker', name: 'Andrew Bailey', title: 'BOE Gov', hp: 6, atk: 5, spd: 4, rate: 7, color: '#9933ff', q:'Gilt Market', w:'Intervention', r:'Stability', qDesc:'ÂõΩÂÄ∫ÂÜ≤Âáª', wDesc:'Âπ≤È¢ÑÊä§Áõæ', rDesc:'ÈáëËûçÁ®≥ÂÆö' },
      'yigang': { cat: 'banker', name: 'Yi Gang', title: 'Ex-PBOC Gov', hp: 7, atk: 5, spd: 5, rate: 7, color: '#cc0000', q:'Prudent Policy', w:'FX Reserve', r:'Structural', qDesc:'Á®≥ÂÅ•ÊîøÁ≠ñ', wDesc:'Â§ñÊ±áÂÇ®Â§áÁõæ', rDesc:'ÁªìÊûÑÊÄßÂ∑•ÂÖ∑' },
      'pan': { cat: 'banker', name: 'Pan Gongsheng (ÊΩòÂäüËÉú)', title: 'PBOC Gov', hp: 8, atk: 5, spd: 5, rate: 8, color: '#ff3333', q:'RRR Cut', w:'Swap Line', e:'Cross-Border', r:'Flood', qDesc:'ÈôçÂáÜÂÜ≤ÂáªÊ≥¢', wDesc:'‰∫íÊç¢ÈÄöÊä§Áõæ', eDesc:'Ë∑®Â¢ÉÁ©øÊ¢≠', rDesc:'ÊµÅÂä®ÊÄßÊ¥™ÊµÅ', qInfo:'AoE | CD: 5s', wInfo:'Reflect | CD: 12s', eInfo:'Teleport | CD: 6s', rInfo:'High Dmg | CD: 35s' },

      // 2. Politicians
      'biden': { cat: 'politician', name: 'Joe Biden (ÊãúÁôª)', title: 'US President', hp: 9, atk: 6, spd: 3, rate: 5, color: '#0000cc', q:'Inflation Act', w:'Alliance', e:'Air Force 1', r:'Chips Ban', qDesc:'ÈÄöËÉÄÊ≥ïÊ°àÈáçÂáª', wDesc:'ÁõüÂèãÂè¨Âî§', eDesc:'Á©∫ÂÜõ‰∏ÄÂè∑', rDesc:'ËäØÁâáÁ¶Å‰ª§ÂÖ®Â±èÂáèÈÄü', qInfo:'Heavy Dmg | CD: 4s', wInfo:'Summon | CD: 20s', eInfo:'Fly | CD: 8s', rInfo:'Slow All | CD: 50s' },
      'trump': { cat: 'politician', name: 'Donald Trump (ÁâπÊúóÊôÆ)', title: 'Former Pres', hp: 8, atk: 9, spd: 5, rate: 6, color: '#ff0000', q:'Twitter Storm', w:'Tariff Wall', e:'Golf Cart', r:'Trade War', qDesc:'Êé®ÁâπÂ£∞Ê≥¢', wDesc:'ÂÖ≥Á®éÂ¢ô', eDesc:'È´òÂ∞îÂ§´ÂÜ≤Âà∫', rDesc:'Ë¥∏ÊòìÊàòÊ†∏Âºπ', qInfo:'Cone Dmg | CD: 2s', wInfo:'Wall | CD: 15s', eInfo:'Stun Dash | CD: 8s', rInfo:'Screen Wipe | CD: 60s' },
      'obama': { cat: 'politician', name: 'Barack Obama', title: 'Former President', hp: 8, atk: 5, spd: 6, rate: 7, color: '#0066cc', q:'Stimulus', w:'Obamacare', r:'Hope', qDesc:'Âà∫ÊøÄËÆ°Âàí', wDesc:'Âåª‰øùÂõûË°Ä', rDesc:'Â∏åÊúõ‰πãÂÖâ' },
      'xi': { cat: 'politician', name: 'Xi Jinping (‰π†ËøëÂπ≥)', title: 'President', hp: 10, atk: 7, spd: 4, rate: 6, color: '#ffcc00', q:'Dual Circle', w:'Prosperity', e:'Steady Step', r:'Belt & Road', qDesc:'ÂèåÂæ™ÁéØÁéØÁªï', wDesc:'ÂÖ±ÂêåÂØåË£ï', eDesc:'Á®≥ÂÅ•Ê≠•‰ºê', rDesc:'‰∏ÄÂ∏¶‰∏ÄË∑Ø', qInfo:'Spin Dmg | CD: 6s', wInfo:'Heal | CD: 15s', eInfo:'Armor Dash | CD: 10s', rInfo:'Charge | CD: 45s' },
      'liqiang': { cat: 'politician', name: 'Li Qiang', title: 'Premier', hp: 8, atk: 6, spd: 6, rate: 7, color: '#ff9900', q:'Open Up', w:'Service', r:'High Quality', qDesc:'ÂºÄÊîæÈó®Êà∑', wDesc:'ÊúçÂä°ÂûãÈò≤Âæ°', rDesc:'È´òË¥®ÈáèÂèëÂ±ï' },
      'putin': { cat: 'politician', name: 'Vladimir Putin (ÊôÆ‰∫¨)', title: 'Russian Pres', hp: 9, atk: 9, spd: 2, rate: 4, color: '#fff', q:'Energy Cut', w:'Iron Curtain', e:'KGB Dash', r:'Special Op', qDesc:'ËÉΩÊ∫êÂàáÊñ≠', wDesc:'ÈìÅÂπïÈò≤Âæ°', eDesc:'ÁâπÂ∑•Á™ÅË¢≠', rDesc:'ÁâπÁßçË°åÂä®', qInfo:'Freeze | CD: 5s', wInfo:'Block All | CD: 15s', eInfo:'Stealth | CD: 8s', rInfo:'Explosion | CD: 50s' },
      'macron': { cat: 'politician', name: 'Emmanuel Macron (È©¨ÂÖãÈæô)', title: 'French Pres', hp: 7, atk: 6, spd: 6, rate: 7, color: '#0055a4', q:'Reform', w:'Autonomy', e:'Diplomacy', r:'Euro Army', qDesc:'ÊîπÈù©Á©øÈÄè', wDesc:'ÊàòÁï•Ëá™‰∏ªÁõæ', eDesc:'Â§ñ‰∫§Êñ°Êóã', rDesc:'Ê¨ßÊ¥≤ÂÜõÂõ¢', qInfo:'Pierce | CD: 3s', wInfo:'Absorb | CD: 10s', eInfo:'Invuln | CD: 5s', rInfo:'Summon | CD: 40s' },
      'scholz': { cat: 'politician', name: 'Olaf Scholz', title: 'German Chancellor', hp: 8, atk: 5, spd: 4, rate: 6, color: '#000000', q:'Zeitenwende', w:'Industry', r:'Budget', qDesc:'Êó∂‰ª£ËΩ¨Êäò', wDesc:'Â∑•‰∏öÊä§Áõæ', rDesc:'È¢ÑÁÆóÂ§ßÁÇÆ' },
      'modi': { cat: 'politician', name: 'Narendra Modi', title: 'Indian PM', hp: 8, atk: 6, spd: 5, rate: 7, color: '#ff9933', q:'Made in India', w:'Yoga', r:'Digital India', qDesc:'Âç∞Â∫¶Âà∂ÈÄ†', wDesc:'Áëú‰ºΩÂõûË°Ä', rDesc:'Êï∞Â≠óÂç∞Â∫¶ÊøÄÂÖâ' },
      'kishida': { cat: 'politician', name: 'Fumio Kishida', title: 'Japanese PM', hp: 6, atk: 5, spd: 5, rate: 7, color: '#cc0033', q:'New Capitalism', w:'Defense', r:'Invest', qDesc:'Êñ∞ËµÑÊú¨‰∏ª‰πâ', wDesc:'Èò≤Âç´Â¢ûÁ®é', rDesc:'ÊäïËµÑÊú™Êù•' },
      'trudeau': { cat: 'politician', name: 'Justin Trudeau', title: 'Canadian PM', hp: 7, atk: 5, spd: 6, rate: 7, color: '#ff0000', q:'Carbon Tax', w:'Multicultural', r:'Emergency', qDesc:'Á¢≥Á®éÊâìÂáª', wDesc:'Â§öÂÖÉÊñáÂåñ', rDesc:'Á¥ßÊÄ•Áä∂ÊÄÅ' },
      'sunak': { cat: 'politician', name: 'Rishi Sunak', title: 'UK Ex-PM', hp: 6, atk: 6, spd: 6, rate: 7, color: '#0000ff', q:'Math', w:'Finance', r:'Windsor', qDesc:'Êï∞Â≠¶ËÆ°ÁÆó', wDesc:'ÈáëËûçÂüéÊä§Áõæ', rDesc:'Ê∏©ËééÊ°ÜÊû∂' },

      // 3. Investors
      'buffett': { cat: 'investor', name: 'Warren Buffett (Â∑¥Ëè≤Áâπ)', title: 'Oracle', hp: 6, atk: 10, spd: 2, rate: 4, color: '#339933', q:'Value Shot', w:'Moat', e:'Compound', r:'Snowball', qDesc:'‰ª∑ÂÄºÁãôÂáª', wDesc:'Êä§ÂüéÊ≤≥', eDesc:'Â§çÂà©‰ΩçÁßª', rDesc:'ÊªöÈõ™ÁêÉ', qInfo:'Crit | CD: 5s', wInfo:'Invuln | CD: 20s', eInfo:'Short Dash | CD: 2s', rInfo:'Grow Dmg | CD: 50s' },
      'munger': { cat: 'investor', name: 'Charlie Munger', title: 'The Architect', hp: 5, atk: 10, spd: 1, rate: 3, color: '#555555', q:'Wisdom', w:'Patience', r:'Lollapalooza', qDesc:'Êô∫ÊÖßÁÆ¥Ë®Ä', wDesc:'ËÄêÂøÉÁ≠âÂæÖ', rDesc:'ÊïàÂ∫îÂè†Âä†' },
      'dalio': { cat: 'investor', name: 'Ray Dalio (ËææÂà©Ê¨ß)', title: 'Bridgewater', hp: 7, atk: 6, spd: 5, rate: 8, color: '#6600cc', q:'All Weather', w:'Deleverage', e:'Cycle Surf', r:'Big Cycle', qDesc:'ÂÖ®Â§©ÂÄôÊï£Â∞Ñ', wDesc:'ÂéªÊù†ÊùÜ', eDesc:'Âë®ÊúüÂÜ≤Êµ™', rDesc:'Â§ßÂë®ÊúüÈáçÁΩÆ', qInfo:'Spread | CD: 3s', wInfo:'Push | CD: 8s', eInfo:'Speed | CD: 5s', rInfo:'Reset | CD: 60s' },
      'marks': { cat: 'investor', name: 'Howard Marks', title: 'Oaktree', hp: 6, atk: 7, spd: 4, rate: 6, color: '#996633', q:'Cycle Memo', w:'Risk Control', r:'Distressed', qDesc:'Â§áÂøòÂΩï', wDesc:'È£éÊéß', rDesc:'Âõ∞Â¢ÉÂèçËΩ¨' },
      'tepper': { cat: 'investor', name: 'David Tepper', title: 'Appaloosa', hp: 6, atk: 9, spd: 6, rate: 7, color: '#003366', q:'Bullish', w:'Fed Put', r:'Buy Everything', qDesc:'ÁâõÂ∏ÇÂÜ≤Âáª', wDesc:'ËÅîÂÇ®ÁúãË∑å', rDesc:'‰π∞ÂÖ•‰∏ÄÂàá' },
      'griffin': { cat: 'investor', name: 'Ken Griffin', title: 'Citadel', hp: 8, atk: 8, spd: 8, rate: 9, color: '#000099', q:'HFT', w:'Market Maker', r:'Algo Dominance', qDesc:'È´òÈ¢ë‰∫§Êòì', wDesc:'ÂÅöÂ∏ÇÂïÜ', rDesc:'ÁÆóÊ≥ïÁªüÊ≤ª' },
      'ackman': { cat: 'investor', name: 'Bill Ackman', title: 'Pershing Square', hp: 6, atk: 8, spd: 7, rate: 7, color: '#999999', q:'Activist', w:'Hedge', r:'Big Short', qDesc:'ÊøÄËøõÊäïËµÑ', wDesc:'ÂØπÂÜ≤', rDesc:'Â§ßÁ©∫Â§¥' },
      'soros': { cat: 'investor', name: 'George Soros (Á¥¢ÁΩóÊñØ)', title: 'Quantum', hp: 5, atk: 9, spd: 6, rate: 6, color: '#333', q:'Short Sell', w:'Reflexivity', e:'Attack Run', r:'Crash', qDesc:'ÂÅöÁ©∫Êö¥Âáª', wDesc:'ÂèçË∫´ÊÄß', eDesc:'Á™ÅË¢≠', rDesc:'Âà∂ÈÄ†Â¥©Áõò', qInfo:'High Dmg | CD: 4s', wInfo:'Dodge | CD: 10s', eInfo:'Dash | CD: 4s', rInfo:'Life Steal | CD: 45s' },
      'druckenmiller': { cat: 'investor', name: 'Stanley Druckenmiller', title: 'Duquesne', hp: 6, atk: 9, spd: 7, rate: 7, color: '#000000', q:'Macro Bet', w:'Flexibility', r:'Top Down', qDesc:'ÂÆèËßÇÊäºÊ≥®', wDesc:'ÁÅµÊ¥ªÈÖçÁΩÆ', rDesc:'Ëá™‰∏äËÄå‰∏ã' },
      'schwarzman': { cat: 'investor', name: 'Stephen Schwarzman', title: 'Blackstone', hp: 8, atk: 7, spd: 5, rate: 6, color: '#000000', q:'Private Equity', w:'Real Estate', r:'Capital', qDesc:'ÁßÅÂãüËÇ°ÊùÉ', wDesc:'‰∏çÂä®‰∫ß', rDesc:'ËµÑÊú¨Ê¥™ÊµÅ' },
      'kravis': { cat: 'investor', name: 'Henry Kravis', title: 'KKR', hp: 7, atk: 8, spd: 5, rate: 6, color: '#cc0000', q:'LBO', w:'Management', r:'Buyout', qDesc:'Êù†ÊùÜÊî∂Ë¥≠', wDesc:'ÁÆ°ÁêÜ‰ºòÂåñ', rDesc:'Êî∂Ë¥≠ÂÖ®Âú∫' },
      'simons': { cat: 'investor', name: 'Jim Simons (Ë•øËíôÊñØ)', title: 'Renaissance', hp: 6, atk: 8, spd: 9, rate: 10, color: '#006600', q:'Algo Beam', w:'Black Box', e:'Data Jump', r:'Medallion', qDesc:'ÁÆóÊ≥ïÂÖâÊùü', wDesc:'ÈªëÁÆ±Èò≤Âæ°', eDesc:'Êï∞ÊçÆË∑≥Ë∑É', rDesc:'Â§ßÂ•ñÁ´†Êî∂Áõä', qInfo:'Beam | CD: 2s', wInfo:'Shield | CD: 12s', eInfo:'Teleport | CD: 3s', rInfo:'Gold Rain | CD: 40s' },

      // 4. Tech
      'musk': { cat: 'tech', name: 'Elon Musk (È©¨ÊñØÂÖã)', title: 'Technoking', hp: 6, atk: 8, spd: 9, rate: 9, color: '#999', q:'Doge Rocket', w:'Starshield', e:'Hyperloop', r:'Mars Colony', qDesc:'ÁãóÁãóÂ∏ÅÁÅ´ÁÆ≠', wDesc:'ÊòüÈìæÂäõÂú∫', eDesc:'ÁúüÁ©∫ÁÆ°ÈÅì', rDesc:'ÁÅ´ÊòüÊÆñÊ∞ë', qInfo:'Random | CD: 1s', wInfo:'Reflect | CD: 8s', eInfo:'Max Spd | CD: 4s', rInfo:'Bombard | CD: 30s' },
      'bezos': { cat: 'tech', name: 'Jeff Bezos', title: 'Amazon', hp: 7, atk: 7, spd: 6, rate: 8, color: '#ff9900', q:'Prime', w:'Cloud', r:'Logistic', qDesc:'PrimeÈ£ûÂºπ', wDesc:'‰∫ëÁõæ', rDesc:'Áâ©ÊµÅÁΩëÁªú' },
      'cook': { cat: 'tech', name: 'Tim Cook', title: 'Apple', hp: 8, atk: 6, spd: 5, rate: 7, color: '#aaaaaa', q:'Supply Chain', w:'Privacy', r:'Ecosystem', qDesc:'‰æõÂ∫îÈìæ', wDesc:'ÈöêÁßÅÁõæ', rDesc:'ÁîüÊÄÅÂõ¥Â¢ô' },
      'zuckerberg': { cat: 'tech', name: 'Mark Zuckerberg (ÊâéÂÖã‰ºØÊ†º)', title: 'Meta', hp: 6, atk: 7, spd: 7, rate: 8, color: '#0066ff', q:'Metaverse', w:'Connect', e:'VR Step', r:'Virtual World', qDesc:'ÂÖÉÂÆáÂÆôÊ≥¢', wDesc:'ËøûÊé•', eDesc:'VRÊ≠•', rDesc:'ËôöÊãü‰∏ñÁïå', qInfo:'Wave | CD: 3s', wInfo:'Link | CD: 10s', eInfo:'Teleport | CD: 5s', rInfo:'Confuse | CD: 40s' },
      'nadella': { cat: 'tech', name: 'Satya Nadella', title: 'Microsoft', hp: 8, atk: 7, spd: 6, rate: 8, color: '#00a1f1', q:'Copilot', w:'Enterprise', r:'Cloud AI', qDesc:'ÂâØÈ©æÈ©∂', wDesc:'‰ºÅ‰∏öÁ∫ß', rDesc:'‰∫ëÁ´ØAI' },
      'huang': { cat: 'tech', name: 'Jensen Huang (ÈªÑ‰ªÅÂãã)', title: 'NVIDIA', hp: 5, atk: 10, spd: 8, rate: 10, color: '#76b900', q:'CUDA', w:'Ray Tracing', e:'Tensor', r:'Singularity', qDesc:'CUDAÂºπÂπï', wDesc:'ÂÖâËøΩÂèçÂ∞Ñ', eDesc:'Âº†ÈáèÂä†ÈÄü', rDesc:'AIÂ•áÁÇπ', qInfo:'Split | CD: 2s', wInfo:'Mirror | CD: 12s', eInfo:'Dash | CD: 6s', rInfo:'Black Hole | CD: 45s' },
      'ponyma': { cat: 'tech', name: 'Pony Ma', title: 'Tencent', hp: 7, atk: 7, spd: 6, rate: 9, color: '#33ccff', q:'WeChat', w:'Social', r:'Game Empire', qDesc:'ÂæÆ‰ø°ËøûÊé•', wDesc:'Á§æ‰∫§ÁΩëÁªú', rDesc:'Ê∏∏ÊàèÂ∏ùÂõΩ' },
      'jackma': { cat: 'tech', name: 'Jack Ma', title: 'Alibaba', hp: 6, atk: 8, spd: 7, rate: 8, color: '#ff6600', q:'E-Commerce', w:'Payment', r:'Data', qDesc:'ÁîµÂïÜÊ¥™ÊµÅ', wDesc:'ÊîØ‰ªòÁõæ', rDesc:'Êï∞ÊçÆ‰∫ë' },
      'robinli': { cat: 'tech', name: 'Robin Li', title: 'Baidu', hp: 6, atk: 6, spd: 6, rate: 7, color: '#0033cc', q:'Search', w:'Auto', r:'Ernie Bot', qDesc:'ÊêúÁ¥¢Á¥¢Âºï', wDesc:'Ëá™Âä®È©æÈ©∂', rDesc:'ÊñáÂøÉ‰∏ÄË®Ä' },

      // 5. Org
      'georgieva': { cat: 'org', name: 'Kristalina Georgieva', title: 'IMF', hp: 8, atk: 4, spd: 5, rate: 6, color: '#003399', q:'SDR', w:'Austerity', e:'Rescue', r:'Global Fund', qDesc:'SDRÊîØÊè¥', wDesc:'Á¥ßÁº©', eDesc:'ÊïëÊè¥‰ΩçÁßª', rDesc:'ÂÖ®ÁêÉÂü∫Èáë', qInfo:'Support | CD: 4s', wInfo:'Slow | CD: 10s', eInfo:'Heal Self | CD: 15s', rInfo:'Full Heal | CD: 60s' },
      'banga': { cat: 'org', name: 'Ajay Banga', title: 'World Bank', hp: 8, atk: 4, spd: 5, rate: 6, color: '#0099cc', q:'Development', w:'Poverty', r:'Infrastructure', qDesc:'ÂèëÂ±ïÊè¥Âä©', wDesc:'Êâ∂Ë¥´', rDesc:'Âü∫Âª∫ÁãÇÈ≠î' },
      'okonjo': { cat: 'org', name: 'Ngozi Okonjo-Iweala', title: 'WTO', hp: 7, atk: 4, spd: 5, rate: 6, color: '#00cc00', q:'Trade Flow', w:'Dispute', r:'Global Market', qDesc:'Ë¥∏ÊòìÊµÅ', wDesc:'‰∫âÁ´ØËß£ÂÜ≥', rDesc:'ÂÖ®ÁêÉÂ∏ÇÂú∫' },
      'guterres': { cat: 'org', name: 'Ant√≥nio Guterres', title: 'UN SG', hp: 9, atk: 2, spd: 4, rate: 5, color: '#3399ff', q:'Resolution', w:'Peace', r:'Humanity', qDesc:'ÂÜ≥ËÆÆ', wDesc:'Áª¥Âíå', rDesc:'‰∫∫Á±ªÂëΩËøê' },
      'stoltenberg': { cat: 'org', name: 'Jens Stoltenberg', title: 'NATO SG', hp: 7, atk: 8, spd: 6, rate: 6, color: '#003366', q:'Article 5', w:'Defense', r:'Alliance', qDesc:'Á¨¨‰∫îÊù°Ê¨æ', wDesc:'ÂÖ±ÂêåÈò≤Âæ°', rDesc:'ÂÜõ‰∫ãËÅîÁõü' }
    };

    // Ë£ÖÂ§áÊï∞ÊçÆ
    const ITEMS = {
      'inf_sword': { type: 'attack', name: 'Infinity Ledger', cost: 1500, icon: '‚öîÔ∏è', stats: { dmg: 2, rate: 0.8 }, desc: 'ÊîªÂáªÂäõÂ§ßÂπÖÊèêÂçáÔºåÂ∞ÑÈÄüÂä†Âø´', passive: 'Multi-Shot' },
      'hft_chip': { type: 'attack', name: 'HFT Chip', cost: 1200, icon: 'üíæ', stats: { rate: 0.6 }, desc: 'È´òÈ¢ë‰∫§ÊòìËäØÁâáÔºåÂ∞ÑÈÄüÁøªÂÄç', passive: 'Rapid Fire' },
      'bull_horn': { type: 'attack', name: 'Bull Horn', cost: 2000, icon: 'üêÇ', stats: { dmg: 3 }, desc: 'ÁâõÂ∏Ç‰πãËßíÔºå‰º§ÂÆ≥ÊûÅÈ´ò', passive: 'Knockback' },
      'invisible_hand': { type: 'attack', name: 'Invisible Hand', cost: 2500, icon: 'üñêÔ∏è', stats: { dmg: 1 }, desc: '„ÄêË¢´Âä®„ÄëÂ≠êÂºπËá™Âä®ËøΩË∏™Êïå‰∫∫', passive: 'homing' },
      
      'gold_armor': { type: 'defense', name: 'Gold Reserve', cost: 1000, icon: 'ü•á', stats: { maxHp: 50 }, desc: 'Â¢ûÂä† 50 ÁÇπÁîüÂëΩ‰∏äÈôê', passive: 'Armor' },
      'fed_put': { type: 'defense', name: 'Fed Put', cost: 1800, icon: 'üìâ', stats: { hpRegen: 0.2 }, desc: 'ÁæéËÅîÂÇ®ÁúãË∑åÊúüÊùÉÔºåÊØèÁßíÂõûË°Ä', passive: 'hpRegen' },
      'bretton_shield': { type: 'defense', name: 'Bretton Shield', cost: 2200, icon: 'üõ°Ô∏è', stats: { maxHp: 30 }, desc: '„ÄêË¢´Âä®„ÄëÊØè10ÁßíÁîüÊàê‰∏Ä‰∏™ÊäµÊå°‰º§ÂÆ≥ÁöÑÊä§Áõæ', passive: 'shield' },
      
      'rocket_boots': { type: 'utility', name: 'Liquidity Boots', cost: 800, icon: 'üë¢', stats: { spd: 2 }, desc: 'Â¢ûÂä†ÁßªÂä®ÈÄüÂ∫¶', passive: 'Speed' },
      'comp_interest': { type: 'utility', name: 'Compound Int.', cost: 1500, icon: 'üìà', stats: {}, desc: '„ÄêË¢´Âä®„ÄëÊØèÁßíËé∑Âæó 5 GDP', passive: 'income' },
      'helicopter': { type: 'utility', name: 'Helicopter', cost: 3000, icon: 'üöÅ', stats: { spd: 3 }, desc: '„ÄêË¢´Âä®„ÄëÁßªÂä®Êó∂Áïô‰∏ã‰º§ÂÆ≥Ë∑ØÂæÑ', passive: 'trail' }
    };

    /* ====== Ê†∏ÂøÉÂèòÈáè ====== */
    let selectedCharId = 'powell';
    let difficultyMultiplier = 1;
    let state = { screen: 'menu', score: 0, frame: 0, player: null, bullets: [], enemies: [], particles: [], texts: [], inventory: [] };
    const input = { mouse: {x:0,y:0}, mouseDown: false };

    // ÂºïÊìéÂàùÂßãÂåñ
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize);
    resize();

    // Ê∏∏ÊàèÂæ™ÁéØ
    function gameLoop() {
      requestAnimationFrame(gameLoop);
      if (state.screen === 'playing') {
        update();
        render();
        state.frame++;
      } else if (state.screen === 'shop') {
        render(); // Keep rendering bg
      }
    }

    /* ====== ÈÄâ‰∫∫ÈÄªËæë (Fixed) ====== */
    function goToCharSelect() {
      document.getElementById('screen-rules').classList.add('hidden');
      document.getElementById('screen-char').classList.remove('hidden');
      filterChars('banker'); // Default
      updateDetailPanel('powell');
    }

    function filterChars(cat) {
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');

      const container = document.getElementById('char-list-container');
      container.innerHTML = '';
      
      for (const [id, data] of Object.entries(CHARACTERS)) {
        if (data.cat === cat) {
          const div = document.createElement('div');
          div.className = `char-mini-card ${id === selectedCharId ? 'selected' : ''}`;
          div.onclick = () => { 
            selectedCharId = id;
            // Update highlights
            document.querySelectorAll('.char-mini-card').forEach(c => c.classList.remove('selected'));
            div.classList.add('selected');
            updateDetailPanel(id); 
          };
          div.innerHTML = `
            <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=${data.name.replace(/ /g,'')}&backgroundColor=b6e3f4,c0aede,d1d4f9" class="mini-avatar">
            <div class="mini-name">${data.name}</div>
          `;
          container.appendChild(div);
        }
      }
    }

    function updateDetailPanel(id) {
      const d = CHARACTERS[id];
      document.getElementById('detail-name').innerText = d.name;
      document.getElementById('detail-title').innerText = d.title;
      document.getElementById('detail-avatar').src = `https://api.dicebear.com/9.x/avataaars/svg?seed=${d.name.replace(/ /g,'')}&backgroundColor=b6e3f4,c0aede,d1d4f9`;
      
      document.getElementById('bar-hp').style.width = (d.hp * 10) + '%';
      document.getElementById('bar-atk').style.width = (d.atk * 10) + '%';
      document.getElementById('bar-spd').style.width = (d.spd * 10) + '%';
      document.getElementById('bar-rate').style.width = (d.rate * 8) + '%';
      
      // Skills
      document.getElementById('skill-q-name').innerText = d.q; document.getElementById('skill-q-desc').innerText = d.qDesc;
      document.getElementById('skill-w-name').innerText = d.w; document.getElementById('skill-w-desc').innerText = d.wDesc;
      document.getElementById('skill-e-name').innerText = d.e || '-'; document.getElementById('skill-e-desc').innerText = d.eDesc || '-';
      document.getElementById('skill-r-name').innerText = d.r; document.getElementById('skill-r-desc').innerText = d.rDesc;
    }

    function startGame() {
      const d = CHARACTERS[selectedCharId];
      state.player = {
        x: canvas.width/2, y: canvas.height/2,
        baseHp: d.hp*20, hp: d.hp*20, maxHp: d.hp*20,
        baseSpd: d.spd*0.8+2, baseDmg: d.atk*0.8+1, baseRate: Math.max(4, 40 - (d.rate*3)),
        color: d.color, r: 20, moving: false, targetX: 0, targetY: 0,
        cd: {q:0, w:0, e:0, r:0},
        img: new Image()
      };
      state.player.img.src = `https://api.dicebear.com/9.x/avataaars/svg?seed=${d.name.replace(/ /g,'')}&backgroundColor=b6e3f4,c0aede,d1d4f9`;
      
      state.bullets = []; state.enemies = []; state.particles = []; state.texts = [];
      state.score = 1000;
      state.screen = 'playing';
      
      document.getElementById('screen-char').classList.add('hidden');
      document.getElementById('ui-layer').classList.remove('hidden');
      gameLoop();
    }

    /* ====== Ê∏∏ÊàèÈÄªËæë ====== */
    function update() {
      const p = state.player;
      if (!p || p.hp <= 0) return;

      // Â±ûÊÄßÈáçÁÆó (Base + Items)
      let spd = p.baseSpd, dmg = p.baseDmg, rate = p.baseRate, hpMax = p.baseMaxHp;
      let passives = [];
      state.inventory.forEach(id => {
        const it = ITEMS[id];
        if(it.stats.spd) spd += it.stats.spd;
        if(it.stats.dmg) dmg += it.stats.dmg;
        if(it.stats.rate) rate *= it.stats.rate;
        if(it.stats.maxHp) hpMax += it.stats.maxHp;
        if(it.passive) passives.push(it.passive);
      });
      p.maxHp = hpMax;

      // Passives
      if(state.frame % 60 === 0 && passives.includes('income')) { state.score += 5; spawnFloatingText(p.x, p.y-20, "+5", "#ffee00"); }
      if(state.frame % 60 === 0 && passives.includes('hpRegen')) p.hp = Math.min(p.hp+1, p.maxHp);
      if(state.frame % 600 === 0 && passives.includes('shield')) { p.shield = true; spawnFloatingText(p.x, p.y, "SHIELD", "#00ff9d"); }

      // Move
      if (p.moving) {
        let dx = p.targetX - p.x, dy = p.targetY - p.y;
        let dist = Math.sqrt(dx*dx + dy*dy);
        if (dist < spd) { p.x = p.targetX; p.y = p.targetY; p.moving = false; }
        else { p.x += (dx/dist)*spd; p.y += (dy/dist)*spd; }
        if(passives.includes('trail') && state.frame % 10 === 0) createParticles(p.x, p.y, '#ff9900', 2);
      }
      // Bounds
      p.x = Math.max(20, Math.min(canvas.width-20, p.x));
      p.y = Math.max(20, Math.min(canvas.height-20, p.y));

      // Cooldowns & HUD
      p.angle = Math.atan2(input.mouse.y - p.y, input.mouse.x - p.x);
      for(let k in p.cd) if(p.cd[k]>0) p.cd[k]--;
      updateHUD();

      // Attack
      if(input.mouseDown && state.frame % Math.ceil(rate) === 0) {
        shootBullet(p, dmg, passives.includes('homing'));
      }

      // Bullets
      for(let i=state.bullets.length-1; i>=0; i--) {
        let b = state.bullets[i];
        if(b.homing && state.enemies.length>0) {
           let target = state.enemies[0]; // Simple homing to first
           let angle = Math.atan2(target.y-b.y, target.x-b.x);
           b.vx = b.vx*0.9 + Math.cos(angle)*2; b.vy = b.vy*0.9 + Math.sin(angle)*2;
        }
        b.x += b.vx; b.y += b.vy; b.life--;
        if(b.life<=0) state.bullets.splice(i,1);
      }

      // Enemies
      if(state.frame % (60/difficultyMultiplier) === 0) spawnEnemy();
      for(let i=state.enemies.length-1; i>=0; i--) {
        let e = state.enemies[i];
        let angle = Math.atan2(p.y - e.y, p.x - e.x);
        e.x += Math.cos(angle)*e.speed; e.y += Math.sin(angle)*e.speed;

        // Collision Player
        if(Math.hypot(p.x-e.x, p.y-e.y) < p.r+e.r) {
          if(p.shield) { p.shield = false; spawnFloatingText(p.x, p.y, "BLOCKED", "#fff"); e.x -= Math.cos(angle)*50; e.y -= Math.sin(angle)*50; }
          else { p.hp -= 10; createParticles(p.x, p.y, '#ff0000', 10); if(p.hp<=0) gameOver(); }
          state.enemies.splice(i,1); continue;
        }
        // Collision Bullet
        for(let j=state.bullets.length-1; j>=0; j--) {
          let b = state.bullets[j];
          if(Math.hypot(b.x-e.x, b.y-e.y) < e.r+5) {
            e.hp -= b.dmg; state.bullets.splice(j,1);
            if(e.hp<=0) {
               state.score += e.val; spawnFloatingText(e.x, e.y, `+$${e.val}`, "#00ff9d");
               state.enemies.splice(i,1); createParticles(e.x, e.y, e.color, 8); break;
            }
          }
        }
      }
      updateParticles();
    }

    function render() {
      ctx.fillStyle = 'rgba(5,5,10,0.3)'; ctx.fillRect(0,0,canvas.width,canvas.height);
      const p = state.player;
      if(!p) return;

      if(p.moving) {
        ctx.strokeStyle='#00ff00'; ctx.beginPath();
        ctx.moveTo(p.targetX-5, p.targetY-5); ctx.lineTo(p.targetX+5, p.targetY+5);
        ctx.moveTo(p.targetX+5, p.targetY-5); ctx.lineTo(p.targetX-5, p.targetY+5);
        ctx.stroke();
      }

      ctx.save(); ctx.translate(p.x, p.y);
      if(p.shield) { ctx.strokeStyle='#fff'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(0,0,25,0,Math.PI*2); ctx.stroke(); }
      if(p.img && p.img.complete) {
        ctx.save(); ctx.beginPath(); ctx.arc(0,0,20,0,Math.PI*2); ctx.clip();
        ctx.drawImage(p.img, -20, -20, 40, 40); ctx.restore();
        ctx.strokeStyle=p.color; ctx.lineWidth=2; ctx.stroke();
      } else {
        ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(0,0,20,0,Math.PI*2); ctx.fill();
      }
      // Health
      ctx.fillStyle="red"; ctx.fillRect(-20, 25, 40, 4);
      ctx.fillStyle="#00ff00"; ctx.fillRect(-20, 25, 40*(Math.max(0,p.hp)/p.maxHp), 4);
      ctx.restore();

      state.enemies.forEach(e=>{ ctx.fillStyle=e.color; ctx.beginPath(); ctx.arc(e.x,e.y,e.r,0,Math.PI*2); ctx.fill(); });
      state.bullets.forEach(b=>{ ctx.fillStyle=b.color; ctx.beginPath(); ctx.arc(b.x,b.y,4,0,Math.PI*2); ctx.fill(); });
      state.particles.forEach(pt=>{ ctx.fillStyle=pt.color; ctx.globalAlpha=pt.life/30; ctx.beginPath(); ctx.arc(pt.x,pt.y,pt.size,0,Math.PI*2); ctx.fill(); });
      ctx.globalAlpha=1;
      ctx.fillStyle="#fff"; ctx.font="bold 14px monospace";
      state.texts.forEach(t=>ctx.fillText(t.text, t.x, t.y));
    }

    /* ====== Helpers ====== */
    function spawnEnemy() {
      let angle = Math.random()*Math.PI*2;
      let r = Math.max(width, height)/2 + 50;
      state.enemies.push({
        x: width/2+Math.cos(angle)*r, y: height/2+Math.sin(angle)*r,
        hp: 10*difficultyMultiplier, speed: 2*difficultyMultiplier, r: 15, color: '#ff0055', val: 50
      });
    }
    function shootBullet(p, dmg, homing) {
      state.bullets.push({
        x:p.x, y:p.y, vx:Math.cos(p.angle)*15, vy:Math.sin(p.angle)*15, life:60, color:p.color, dmg:dmg, homing:homing
      });
    }
    function useSkill(key) {
      const p = state.player;
      if(p.cd[key]>0) return;
      // Simple Skill Implementations
      if(key==='e') { p.x+=Math.cos(p.angle)*200; p.y+=Math.sin(p.angle)*200; p.targetX=p.x; p.cd[key]=180; }
      if(key==='q') { for(let i=-0.5;i<=0.5;i+=0.25) shootBullet({...p, angle:p.angle+i}, p.baseDmg*1.5, false); p.cd[key]=120; }
      if(key==='w') { state.enemies.forEach(e=>{if(Math.hypot(p.x-e.x, p.y-e.y)<200) e.x-=100;}); p.cd[key]=300; }
      if(key==='r') { state.enemies=[]; spawnFloatingText(width/2, height/2, "ULTIMATE!", "#ffee00"); p.cd[key]=900; }
    }
    function updateHUD() {
      document.getElementById('score-val').innerText = Math.floor(state.score);
      document.getElementById('health-val').innerText = Math.floor(state.player.hp);
      ['q','w','e','r'].forEach(k => {
         let cd = state.player.cd[k];
         let el = document.querySelector(`#skill-${k} .cooldown-overlay`);
         if(cd > 0) { el.style.height="100%"; el.querySelector('span').innerText = Math.ceil(cd/60); }
         else { el.style.height="0%"; el.querySelector('span').innerText=""; }
      });
      const slots = document.querySelectorAll('.item-slot');
      state.inventory.forEach((id, i) => {
        if(slots[i].classList.contains('empty')) {
           const item = ITEMS[id];
           slots[i].innerHTML = item.icon;
           slots[i].classList.remove('empty');
           slots[i].onmouseenter = () => showTooltip(null, null, item); // Special handling for item tooltip
           slots[i].onmouseleave = hideTooltip;
        }
      });
    }
    function toggleShop() {
      if(state.screen==='playing'){ state.screen='shop'; document.getElementById('shop-menu').classList.remove('hidden'); filterShop('attack'); }
      else if(state.screen==='shop'){ state.screen='playing'; document.getElementById('shop-menu').classList.add('hidden'); loop(); }
    }
    function filterShop(type) {
      document.querySelectorAll('.shop-tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      const c = document.getElementById('shop-items-container'); c.innerHTML='';
      for(const [id, it] of Object.entries(ITEMS)) {
        if(it.type===type) {
          c.innerHTML += `<div class="shop-item-card" onclick="buyItem('${id}')">
            <div class="shop-item-icon">${it.icon}</div><div class="shop-item-name">${it.name}</div>
            <div class="shop-item-cost">$${it.cost}</div><div class="shop-item-desc">${it.desc}</div>
            <div class="shop-buy-btn btn">BUY</div></div>`;
        }
      }
    }
    function buyItem(id) {
      const it = ITEMS[id];
      if(state.score >= it.cost && state.inventory.length < 6) {
        state.score -= it.cost; state.inventory.push(id);
        document.getElementById('shop-current-gdp').innerText = '$'+state.score;
        spawnFloatingText(width/2, height/2, "BOUGHT!", "#00ff9d");
      } else alert("Not enough GDP or Full!");
    }

    /* Tooltip Logic */
    function showSelectTooltip(el, key) {
      const d = CHARACTERS[selectedCharId];
      showTooltipBase(el, d[key]||key.toUpperCase(), d[key+'Desc'], d[key+'Info']);
    }
    function showGameTooltip(el, key) {
      const d = CHARACTERS[selectedCharId];
      showTooltipBase(el, d[key], d[key+'Desc'], d[key+'Info']);
    }
    function showTooltipBase(el, title, desc, info) {
      const tt = document.getElementById('global-tooltip');
      document.getElementById('tt-title').innerText = title;
      document.getElementById('tt-desc').innerText = desc;
      document.getElementById('tt-info').innerHTML = `<span>${info||''}</span>`;
      const r = el.getBoundingClientRect();
      tt.style.left = (r.left+20)+'px'; tt.style.top = (r.top-120)+'px';
      tt.style.display = 'block';
    }
    function hideTooltip() { document.getElementById('global-tooltip').style.display = 'none'; }
    
    /* Misc */
    window.onkeydown = e => {
      if(state.screen==='playing') {
        if('qwer'.includes(e.key.toLowerCase())) useSkill(e.key.toLowerCase());
        if(e.key.toLowerCase()==='b') toggleShop();
        if(e.key.toLowerCase()==='a') input.mouseDown=true;
        if(e.key==='Escape') togglePause();
      } else if(state.screen==='shop' && e.key.toLowerCase()==='b') toggleShop();
    }
    window.onkeyup = e => { if(e.key.toLowerCase()==='a') input.mouseDown=false; };
    window.onmousemove = e => { input.mouse.x=e.clientX; input.mouse.y=e.clientY; };
    window.onmousedown = e => { if(e.button===0) input.mouseDown=true; if(e.button===2 && state.player) {
      state.player.moving=true; state.player.targetX=e.clientX; state.player.targetY=e.clientY;
    }};
    window.onmouseup = () => input.mouseDown=false;
    window.oncontextmenu = e => e.preventDefault();

    function setDifficulty(v, el) { difficultyMultiplier=v; document.querySelectorAll('.diff-btn').forEach(b=>b.classList.remove('active')); el.classList.add('active'); }
    function togglePause() {
      if(state.screen==='playing') { state.screen='paused'; document.getElementById('pause-menu').classList.remove('hidden'); }
      else if(state.screen==='paused') { state.screen='playing'; document.getElementById('pause-menu').classList.add('hidden'); loop(); }
    }
    function gameOver() { state.screen='over'; document.getElementById('game-over').classList.remove('hidden'); document.getElementById('final-score').innerText=state.score; }
    function createParticles(x,y,c,n) { for(let i=0;i<n;i++) state.particles.push({x,y,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*10,life:30,color:c,size:Math.random()*3}); }
    function spawnFloatingText(x,y,t,c='#fff') { state.texts.push({x,y,text:t,color:c,life:60}); }
    function updateParticles() { 
      for(let i=state.particles.length-1;i>=0;i--){ let p=state.particles[i]; p.x+=p.vx; p.y+=p.vy; p.life--; if(p.life<=0) state.particles.splice(i,1); }
      for(let i=state.texts.length-1;i>=0;i--){ let t=state.texts[i]; t.y--; t.life--; if(t.life<=0) state.texts.splice(i,1); }
    }

    // Init
    // Start loop just to render bg
    function loop() { requestAnimationFrame(loop); render(); }
    loop();
  </script>
</body>
</html>
